import{f as o,m as d,a as m,b as a,d as i,S as u,e as c}from"./Stack.svelte_svelte_type_style_lang.BvmJlThE.js";import"./entry.ClNc0xIF.js";const f=e=>"telegramId"in e;function r(e){const t={id:0,userName:""};return f(e)&&(t.id=e.telegramId,t.userName=e.telegramName),{telegram:t,eventId:e.eventId,meta:{id:e.userId,description:e.userInfo,photoLink:e.photoLink||void 0,userName:e.userName||t.userName}}}function g(e){return{userId:e.meta.id,eventId:e.eventId,userName:e.meta.userName,userInfo:e.meta.description,photoLink:e.meta.photoLink||null}}const I=o(m,"USER_REGISTERED").pipe(d(r)),U=o(m,"USER_UPDATED").pipe(d(r));function l(e){return a.get(`/users/${e}`).then(t=>t.data).then(t=>t.map(r))}function h(e){return a.post(`/form/${e.eventId}/${e.meta.id}`,g(e)).then(t=>t.data).then(r)}function v(e,t){return a.get(`/form/${e}/${t}`).then(n=>n.data).then(r)}function A(e,t){return a.post("/meeting/get_user_for_fast_meeting",{userId:Number(t),eventId:Number(e)})}i(({eventId:e,userId:t})=>v(e,t));const N=i(l),b=i(h),E=u(U),$=u(I),s=e=>`${e.eventId}~${e.meta.id}`;function S(e,t){return e.findIndex(n=>s(n)===s(t))}function x(e,t){const n=new Set(e.map(s));return t.filter(p=>!n.has(s(p)))}const k=c([]).on(N.doneData,(e,t)=>e.concat(x(e,t))).on($,(e,t)=>[...e,t]).on(E,(e,t)=>{const n=S(e,t);return n!==-1?(e[n]=t,[...e]):e});export{b as a,N as g,A as s,k as u};
